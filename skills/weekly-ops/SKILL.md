---
name: weekly-ops
context: fork
description: >
  Use this skill when the user wants to create or fill a weekly plan, weekly report,
  monthly plan, monthly report. Triggers: "–ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é", "–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –ø–ª–∞–Ω",
  "–æ—Ç—á—ë—Ç –∑–∞ –Ω–µ–¥–µ–ª—é", "–∑–∞–ø–æ–ª–Ω–∏ –æ—Ç—á—ë—Ç", "–º–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç", "–ø–ª–∞–Ω –Ω–∞ –º–µ—Å—è—Ü",
  "–æ—Ç—á—ë—Ç –∑–∞ –º–µ—Å—è—Ü", "–∞–≥—Ä–µ–≥–∏—Ä—É–π –æ—Ç—á—ë—Ç—ã", "–∑–∞–ø–æ–ª–Ω–∏ –ø–ª–∞–Ω", "plan", "report",
  "weekly plan", "weekly report", "monthly plan", "monthly report",
  "—Å—Ñ–æ—Ä–º–∏—Ä—É–π –ø–ª–∞–Ω", "—Å—Ñ–æ—Ä–º–∏—Ä—É–π –æ—Ç—á—ë—Ç", "–ø–ª–∞–Ω –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é",
  "–æ—Ç—á—ë—Ç –∑–∞ –ø—Ä–æ—à–ª—É—é –Ω–µ–¥–µ–ª—é"
tools:
  - Bash
  - Read
  - Write
  - Glob
  - mcp__jobs__tg_send_message
  - mcp__jobs__tg_send_media
  - mcp__jobs__tg_download_media
  - mcp__jobs__memory_search
  - mcp__jobs__memory_log
---

# weekly-ops ‚Äî –ü–ª–∞–Ω—ã –∏ –æ—Ç—á—ë—Ç—ã

–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö/–µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ –∏ –æ—Ç—á—ë—Ç–æ–≤. –ü–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Baserow, –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∏–∑ –ø–∞–º—è—Ç–∏, —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–µ—Ç –±–ª–æ–∫–∞–º–∏, –≥–µ–Ω–µ—Ä–∏—Ç .docx.

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞

| –£—Å–ª–æ–≤–∏–µ | –†–µ–∂–∏–º |
|---------|-------|
| "–ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é", "—Å—Ñ–æ—Ä–º–∏—Ä—É–π –ø–ª–∞–Ω", "plan" | PLAN_WEEKLY |
| "–ø–ª–∞–Ω –Ω–∞ –º–µ—Å—è—Ü", "–µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞–Ω" | PLAN_MONTHLY |
| "–æ—Ç—á—ë—Ç –∑–∞ –Ω–µ–¥–µ–ª—é", "–∑–∞–ø–æ–ª–Ω–∏ –æ—Ç—á—ë—Ç", "report" | REPORT_WEEKLY |
| "–æ—Ç—á—ë—Ç –∑–∞ –º–µ—Å—è—Ü", "–º–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç" | REPORT_MONTHLY |
| .docx –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω + –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–ª–∞–Ω–∞/–æ—Ç—á—ë—Ç–∞ | TEMPLATE_FILL |

## State Tracking

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ:

```
mode: PLAN_WEEKLY | PLAN_MONTHLY | REPORT_WEEKLY | REPORT_MONTHLY | TEMPLATE_FILL
period_start: YYYY-MM-DD
period_end: YYYY-MM-DD
doc_type: plan | report
items: [...]
preview_cursor: 0
blocks_total: N
approved_blocks: [...]
pending_edits: {...}
status: detecting | loading | building | previewing | generating | sending | published
work_dir: /dev/shm/weekly-ops/session_xxxxx
```

---

## –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ [CRITICAL]

–≠—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –í–°–ï–ì–î–ê, –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π:

### LL-3: –ù–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ø—ã —Å –ø–ª–∞–Ω–æ–≤—ã–º–∏
–ü–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∑–∞–¥–∞—á–∏ –≤ ¬´–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è¬ª –ø—Ä–æ–≤–µ—Ä—å overlap ‚â• 60% –∑–Ω–∞—á–∏–º—ã—Ö —Å–ª–æ–≤ —Å –ø–ª–∞–Ω–æ–≤—ã–º–∏ –ø—É–Ω–∫—Ç–∞–º–∏. –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Äî –ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å.

### LL-8: –í –ø–ª–∞–Ω–∞—Ö –ù–ï–¢ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
–ù–∏–∫–∞–∫–∏—Ö "50%", "80% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏" –≤ —Ç–µ–∫—Å—Ç–µ –ø—É–Ω–∫—Ç–æ–≤ –ø–ª–∞–Ω–∞. –ü—Ä–æ—Ü–µ–Ω—Ç—ã –¥–æ–ø—É—Å—Ç–∏–º—ã –¢–û–õ–¨–ö–û –≤ –æ—Ç–º–µ—Ç–∫–∞—Ö –æ—Ç—á—ë—Ç–∞.

### LL-9: –í –ø–ª–∞–Ω–∞—Ö –ù–ï–¢ –§–ò–û –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–≤
–ó–∞–º–µ–Ω—è—Ç—å –§–ò–û –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–≤ –Ω–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ ¬´–°–ò–¢¬ª –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: —à—Ç–∞—Ç–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏.

### LL-10: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –í–°–ï –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ pull –≤—Å–µ—Ö –∑–∞–¥–∞—á —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ in_progress/assigned/waiting_input. –ù–µ–ª—å–∑—è –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∑–∞–¥–∞—á—É.

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—É–Ω–∫—Ç—ã
–í –∫–∞–∂–¥–æ–º –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–º –ø–ª–∞–Ω–µ –í–°–ï–ì–î–ê –≤–∫–ª—é—á–∞—Ç—å –ø—É–Ω–∫—Ç—ã –∏–∑ `mandatory_items` –≤ config.json (–ú–æ–ª–æ—Ç–æ–≤–∞ –ê.–í., –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ò–ë, —Å—Ç–∞–∂—ë—Ä –í–æ—Ä–æ–∂–±–∏—Ç).

### –ò—Å–∫–ª—é—á–∏—Ç—å –¶–û–ö
–ü—É–Ω–∫—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¶–û–ö (–¶–µ–Ω—Ç—Ä –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏), –ù–ï –≤–∫–ª—é—á–∞—Ç—å.

### –¢–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
–í –ø–ª–∞–Ω—ã/–æ—Ç—á—ë—Ç—ã –ù–ï –≤–∫–ª—é—á–∞—Ç—å: –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–¥–∞ –±–æ—Ç–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–∏–ª–ª–æ–≤, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –±–æ—Ç–æ–º, AI assistant.

---

## –î–µ–¥–ª–∞–π–Ω—ã

- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –ø–ª–∞–Ω/–æ—Ç—á—ë—Ç: –¥–æ –ø—è—Ç–Ω–∏—Ü—ã —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏
- –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –ø–ª–∞–Ω/–æ—Ç—á—ë—Ç: –¥–æ **20-–≥–æ —á–∏—Å–ª–∞** –º–µ—Å—è—Ü–∞
- –ï—Å–ª–∏ 20-–µ ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π: –¥–æ–ø—É—Å—Ç–∏–º–æ 21-22, –Ω–æ –¢–û–õ–¨–ö–û —Å –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –û–ö owner'–∞
- –ü—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –¥–µ–¥–ª–∞–π–Ω–∞ (17-18 —á–∏—Å–ª–∞) ‚Üí –Ω–∞–ø–æ–º–Ω–∏—Ç—å: "–ú–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç –Ω—É–∂–µ–Ω –¥–æ 20-–≥–æ"

---

## 1. PLAN_WEEKLY

**1.1.** –û–ø—Ä–µ–¥–µ–ª–∏ –ø–µ—Ä–∏–æ–¥:
- –ï—Å–ª–∏ —Å–µ–≥–æ–¥–Ω—è –ø–Ω-—á—Ç ‚Üí —Ç–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è (–ø–Ω-–ø—Ç)
- –ï—Å–ª–∏ —Å–µ–≥–æ–¥–Ω—è –ø—Ç-–≤—Å ‚Üí —Å–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è (–ø–Ω-–ø—Ç)
- Owner –º–æ–∂–µ—Ç —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã

**1.2.** –°–æ–∑–¥–∞–π —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -c "
from config.settings import load_config, create_work_dir
cfg = load_config()
wd = create_work_dir(cfg)
print(wd)
"
```

**1.3.** –ó–∞–≥—Ä—É–∑–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ Baserow:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.data_loader pull --period-start YYYY-MM-DD --period-end YYYY-MM-DD
```

**1.4.** –°–æ—Ö—Ä–∞–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `{work_dir}/raw.json`.

**1.5.** –ü–æ—Å—Ç—Ä–æ–π –ø–ª–∞–Ω:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.plan_builder build --data {work_dir}/raw.json --output {work_dir}/plan.json
```

**1.6.** –ü—Ä–æ—á–∏—Ç–∞–π `{work_dir}/plan.json` –∏ –ø—Ä–æ–≤–µ—Ä—å:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—É–Ω–∫—Ç—ã –µ—Å—Ç—å (–ú–æ–ª–æ—Ç–æ–≤–∞, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Å—Ç–∞–∂—ë—Ä)?
- –¶–û–ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç?
- –ù–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤?
- –ù–µ—Ç –§–ò–û –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–≤?
- –í—Å–µ active –∑–∞–¥–∞—á–∏ –≤–∫–ª—é—á–µ–Ω—ã?

**1.7.** –°—Ñ–æ—Ä–º–∏—Ä—É–π preview –±–ª–æ–∫–∞–º–∏ –ø–æ 5 –ø—É–Ω–∫—Ç–æ–≤:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.preview_formatter plan --data {work_dir}/plan.json --period "–ü–ª–∞–Ω –Ω–∞ DD.MM-DD.MM"
```

**1.8.** –û—Ç–ø—Ä–∞–≤—å –ø–µ—Ä–≤—ã–π –±–ª–æ–∫ owner'—É —á–µ—Ä–µ–∑ `mcp__jobs__tg_send_message`.

**1.9.** –¶–∏–∫–ª —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è:
- "–æ–∫" / "–¥–∞" ‚Üí approve –±–ª–æ–∫, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π
- "–≤—Å—ë –æ–∫" ‚Üí approve –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –±–ª–æ–∫–∏
- "‚ë° —Å—Ä–æ–∫–∏ –¥–æ –ø—è—Ç–Ω–∏—Ü—ã" ‚Üí –ø—Ä–∞–≤–∫–∞, –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –±–ª–æ–∫
- "‚ë§ —É–±—Ä–∞—Ç—å" ‚Üí —É–¥–∞–ª–∏—Ç—å –ø—É–Ω–∫—Ç
- "–¥–æ–±–∞–≤—å: –°–æ–≤–µ—â–∞–Ω–∏–µ –ø–æ –ò–ë | 20.02 | –ü–µ—Ç—Ä–æ–≤" ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∫–∏, –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –Ω—É–º–µ—Ä–∞—Ü–∏—é, –ø–æ–∫–∞–∑–∞—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –±–ª–æ–∫

**1.10.** –ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ ‚Üí —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å .docx:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.docx_generator plan --data {work_dir}/plan_final.json --output {work_dir}/plan.docx
```

**1.11.** –û—Ç–ø—Ä–∞–≤–∏—Ç—å .docx owner'—É —á–µ—Ä–µ–∑ `mcp__jobs__tg_send_media`.

**1.12.** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å plan_items –≤ Baserow:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.baserow batch_create TABLE_ID --data '[...]'
```

**1.13.** –ï—Å–ª–∏ owner –ø—Ä–æ—Å–∏—Ç ‚Äî –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ Pi Space.

**1.14.** –û—á–∏—Å—Ç–∏—Ç—å —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -c "
from config.settings import cleanup_work_dir
from pathlib import Path
cleanup_work_dir(Path('{work_dir}'))
"
```

---

## 2. PLAN_MONTHLY

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ PLAN_WEEKLY, –Ω–æ:
- –ü–µ—Ä–∏–æ–¥ = –≤–µ—Å—å –º–µ—Å—è—Ü (1-–µ ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å)
- –ù–µ—Ç —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ "–ø–ª–∞–Ω–æ–≤—ã–µ/–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ" ‚Äî –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞
- –î–µ–¥–ª–∞–π–Ω: –¥–æ 20-–≥–æ —á–∏—Å–ª–∞
- –ï—Å–ª–∏ 20-–µ –≤—ã—Ö–æ–¥–Ω–æ–π ‚Üí –∑–∞–ø—Ä–æ—Å–∏—Ç—å –û–ö owner'–∞ –Ω–∞ 21-22

---

## 3. REPORT_WEEKLY

**3.1.** –û–ø—Ä–µ–¥–µ–ª–∏ –ø–µ—Ä–∏–æ–¥ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–ª–∞–Ω—É).

**3.2.** –°–æ–∑–¥–∞–π —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.

**3.3.** –ó–∞–≥—Ä—É–∑–∏ –¥–∞–Ω–Ω—ã–µ:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.data_loader pull --period-start YYYY-MM-DD --period-end YYYY-MM-DD
```

**3.4.** –ó–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ—á–Ω—É—é –ø–∞–º—è—Ç—å:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.formulation_memory get_all_as_dict
```

**3.5.** –ü–æ—Å—Ç—Ä–æ–π –æ—Ç—á—ë—Ç:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.report_builder build --data {work_dir}/raw.json --memory {work_dir}/memory.json --output {work_dir}/report.json
```

**3.6.** –ü—Ä–æ—á–∏—Ç–∞–π report.json, –ø—Ä–æ–≤–µ—Ä—å warnings.

**3.7.** –°—Ñ–æ—Ä–º–∏—Ä—É–π preview –±–ª–æ–∫–∞–º–∏ (—Å –æ—Ç–º–µ—Ç–∫–∞–º–∏):
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.preview_formatter report --data {work_dir}/report_items.json --period "–û—Ç—á—ë—Ç –∑–∞ DD.MM-DD.MM"
```

**3.8.** –û—Ç–ø—Ä–∞–≤—å –±–ª–æ–∫ owner'—É.

**3.9.** –¶–∏–∫–ª —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–ª–∞–Ω—É, –Ω–æ —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏):
- "–æ–∫" ‚Üí approve –±–ª–æ–∫
- "‚ë° 80%, –∞–∫—Ç –ø–æ–¥–ø–∏—Å–∞–Ω" ‚Üí –ø—Ä–∞–≤–∫–∞ –æ—Ç–º–µ—Ç–∫–∏
- "–≤—Å—ë –æ–∫" ‚Üí approve –≤—Å–µ

**3.10.** –ü–æ—Å–ª–µ approve ‚Äî –°–û–•–†–ê–ù–ò–¢–¨ —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –≤ memory:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -c "
import json
from services.formulation_memory import bulk_save_approved
with open('{work_dir}/approved_items.json') as f:
    items = json.load(f)
saved = bulk_save_approved(items)
print(f'Saved {saved} formulations')
"
```

**3.11.** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è .docx ‚Äî –¥–≤–∞ –ø—É—Ç–∏:

**a) –ï—Å—Ç—å —à–∞–±–ª–æ–Ω (owner –ø—Ä–∏—Å–ª–∞–ª .docx –∏–ª–∏ —Å–∫–∞—á–∞–Ω –∏–∑ Pi Space):**
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.docx_generator fill --template {work_dir}/template.docx --data {work_dir}/report_final.json --output {work_dir}/report.docx
```

**b) –ù–µ—Ç —à–∞–±–ª–æ–Ω–∞ ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –Ω—É–ª—è:**
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.docx_generator report --data {work_dir}/report_final.json --output {work_dir}/report.docx
```

**3.12.** –û–±–Ω–æ–≤–∏—Ç—å plan_items.completion_note –≤ Baserow.

**3.13.** –û—Ç–ø—Ä–∞–≤–∏—Ç—å + –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å + –æ—á–∏—Å—Ç–∫–∞.

---

## 4. REPORT_MONTHLY

**4.1.** –û–ø—Ä–µ–¥–µ–ª–∏ –º–µ—Å—è—Ü.

**4.2.** –ê–≥—Ä–µ–≥–∏—Ä—É–π –≤—Å–µ –Ω–µ–¥–µ–ª—å–Ω—ã–µ plan_items –∑–∞ –º–µ—Å—è—Ü:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.monthly_aggregator aggregate --month YYYY-MM --output {work_dir}/monthly.json
```

**4.3.** –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—É–Ω–∫—Ç—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö –Ω–µ–¥–µ–ª—å ‚Üí –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–º–µ—Ç–∫–æ–π.

**4.4.** –î–æ–ø—ã ‚Äî –≤ –∫–æ–Ω–µ—Ü —Ç–∞–±–ª–∏—Ü—ã (–±–µ–∑ —Ä–∞–∑–±–∏–µ–Ω–∏—è "–ø–ª–∞–Ω–æ–≤—ã–µ/–¥–æ–ø").

**4.5.** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π flow: preview ‚Üí approve ‚Üí .docx ‚Üí send.

---

## 5. TEMPLATE_FILL

–ö–æ–≥–¥–∞ owner –ø—Ä–∏—Å—ã–ª–∞–µ—Ç .docx —à–∞–±–ª–æ–Ω:

**5.1.** –°–∫–∞—á–∞–π —Ñ–∞–π–ª —á–µ—Ä–µ–∑ `mcp__jobs__tg_download_media` ‚Üí `{work_dir}/template.docx`.

**5.2.** –û–ø—Ä–µ–¥–µ–ª–∏ –ø–µ—Ä–∏–æ–¥ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–ª–∏ —Å–ø—Ä–æ—Å–∏ owner'–∞).

**5.3.** –ó–∞–≥—Ä—É–∑–∏ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ—Å—Ç—Ä–æ–π –æ—Ç—á—ë—Ç (—à–∞–≥–∏ 3.3-3.5).

**5.4.** –ó–∞–ø–æ–ª–Ω–∏ —à–∞–±–ª–æ–Ω:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.docx_generator fill --template {work_dir}/template.docx --data {work_dir}/report.json --output {work_dir}/filled.docx
```

**5.5.** –í–∞–ª–∏–¥–∞—Ü–∏—è:
```bash
cd /workspace/.claude/skills/weekly-ops && PYTHONPATH=. python3 -m services.docx_generator validate --doc {work_dir}/filled.docx
```

**5.6.** –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö ‚Äî –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏ –ø–æ–∫–∞–∑–∞—Ç—å owner'—É.

**5.7.** –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ `mcp__jobs__tg_send_media`.

---

## UX: –§–æ—Ä–º–∞—Ç preview

### –ü–ª–∞–Ω (–±–µ–∑ ¬´–û—Ç–º–µ—Ç–∫–∏¬ª):
```
üìã –ü–ª–∞–Ω –Ω–∞ 17.02-21.02 | –ë–ª–æ–∫ 1/4:

‚ë† –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –ò–ë | –í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏ | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë
‚ë° –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ü–æ—Ä—è–¥–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ò–ë (–ú–æ–ª–æ—Ç–æ–≤–∞ –ê.–í.) | –í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏ | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë
‚ë¢ –°–ø—Ä–∞–≤–∫–∞ –ø–æ –ì–æ—Å–°–û–ü–ö–ê | –¥–æ 19.02 | –°–∏–¥–æ—Ä–æ–≤ –ê.–í.
‚ë£ –ö–æ–Ω—Ç—Ä–æ–ª—å SOC | –í —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏ | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ë
‚ë§ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥–ª–∞–π–Ω–æ–≤ –§–°–¢–≠–ö | –¥–æ 21.02 | –ü–µ—Ç—Ä–æ–≤ –î.–ê.

‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å | ‚úèÔ∏è –ü—Ä–∞–≤–∫–∏ | ‚ûï –î–æ–±–∞–≤–∏—Ç—å
```

### –û—Ç—á—ë—Ç (—Å ¬´–û—Ç–º–µ—Ç–∫–æ–π¬ª):
```
üìä –û—Ç—á—ë—Ç –∑–∞ 17.02-21.02 | –ë–ª–æ–∫ 1/4:

‚ë† –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –ò–ë
   ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–æ. –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ 312 —Å–æ–±—ã—Ç–∏–π, 2 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞.
‚ë° –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ü–æ—Ä—è–¥–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ò–ë (–ú–æ–ª–æ—Ç–æ–≤–∞)
   ‚Üí –í —Ä–∞–±–æ—Ç–µ (60%). –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∞–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω.
‚ë¢ –°–ø—Ä–∞–≤–∫–∞ –ø–æ –ì–æ—Å–°–û–ü–ö–ê
   ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–æ. –°–ø—Ä–∞–≤–∫–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ (—Ä–µ–≥. ‚Ññ42-–ò–ë).

‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å | ‚úèÔ∏è –ü—Ä–∞–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: ‚ë° 80%, –∞–∫—Ç –ø–æ–¥–ø–∏—Å–∞–Ω)
```

### –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤:
- "–æ–∫" / "–¥–∞" ‚Üí approve —Ç–µ–∫—É—â–∏–π –±–ª–æ–∫, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π
- "‚ë° —Å—Ä–æ–∫–∏ –¥–æ –ø—è—Ç–Ω–∏—Ü—ã" ‚Üí –ø—Ä–∞–≤–∫–∞ –ø—É–Ω–∫—Ç–∞ ‚ë°, –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –±–ª–æ–∫
- "‚ë§ —É–±—Ä–∞—Ç—å" ‚Üí —É–¥–∞–ª–∏—Ç—å –ø—É–Ω–∫—Ç ‚ë§
- "–¥–æ–±–∞–≤—å: –°–æ–≤–µ—â–∞–Ω–∏–µ –ø–æ –ò–ë | 20.02 | –ü–µ—Ç—Ä–æ–≤" ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç
- "–≤—Å—ë –æ–∫" ‚Üí approve –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –±–ª–æ–∫–∏ —Ä–∞–∑–æ–º

---

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ .docx

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è | Landscape (29.7 √ó 21 cm) |
| –ü–æ–ª—è | L=3.0, R=1.0, T=2.0, B=2.0 cm |
| –®—Ä–∏—Ñ—Ç —Ç–∞–±–ª–∏—Ü—ã | **12pt TNR** |
| –®—Ä–∏—Ñ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ | 14pt TNR |
| –ö–æ–ª–æ–Ω–∫–∏ | ‚Ññ –ø/–ø (6%) ¬∑ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (38%) ¬∑ –°—Ä–æ–∫–∏ (16%) ¬∑ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π (20%) ¬∑ –û—Ç–º–µ—Ç–∫–∞ (20%) |
| Bold | –¢–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã |
| –ù–µ–¥–µ–ª—å–Ω—ã–π | 2 —Å–µ–∫—Ü–∏–∏: "–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è" (merged) ‚Üí –∑–∞–¥–∞—á–∏ ‚Üí "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ" (merged) ‚Üí –¥–æ–ø—ã |
| –ú–µ—Å—è—á–Ω—ã–π | 1 —Ç–∞–±–ª–∏—Ü–∞ –±–µ–∑ —Ä–∞–∑–±–∏–µ–Ω–∏—è, –¥–æ–ø—ã –≤ –∫–æ–Ω—Ü–µ |

---

## –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å

–ü–æ—Å–ª–µ **explicit approve** –±–ª–æ–∫–∞ owner'–æ–º ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏.

–ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ—Ç—á—ë—Ç–∞ ‚Äî —Å–Ω–∞—á–∞–ª–∞ –∏—Å–∫–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏ –ø–æ keyword overlap (‚â• 60%).
–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω + –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –∑–∞–¥–∞—á.
–ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ task.status + task.result.

---

## –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã (–∫–æ–≥–¥–∞ –ù–ï –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å)

- "—Å–≤–æ–¥–∫–∞" / "–±—Ä–∏—Ñ–∏–Ω–≥" / "—á—Ç–æ –ø–æ –∑–∞–¥–∞—á–∞–º" ‚Üí task-control (BRIEFING)
- "—Ä–∞–∑–±–µ—Ä–∏ –∑–∞–¥–∞—á–∏" / "–ø–∞—Ä—Å–∏" ‚Üí task-control (PARSE_TASKS)
- "–∫—Ç–æ –Ω–∞ —Å–º–µ–Ω–µ" ‚Üí task-control (SHIFT_QUERY)
- "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" / "–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞" ‚Üí task-control (ANALYTICS)
- "–§–°–¢–≠–ö –¥–µ–¥–ª–∞–π–Ω—ã" ‚Üí task-control (REGULATORY)
- –°–ø—Ä–∞–≤–∫–∞ (.docx —Å —à–∞–ø–∫–æ–π) ‚Üí doc-review
