global
    log /dev/stdout local0

defaults
    log global
    mode http
    option httplog
    timeout connect 5s
    timeout client 300s
    timeout server 300s
    timeout tunnel 3600s
    option forwardfor

frontend cdp_frontend
    bind *:9223
    mode http

    # Rewrite Host header to bypass Chromium's check
    # Port 9223 ensures Chromium returns ws://127.0.0.1:9223/... in webSocketDebuggerUrl
    # Playwright's connectOverCDP then rewrites 127.0.0.1 â†’ actual host (browser)
    http-request set-header Host 127.0.0.1:9223
    http-request set-header Origin http://127.0.0.1:9222

    default_backend cdp_backend

backend cdp_backend
    mode http
    server chrome 127.0.0.1:9222
